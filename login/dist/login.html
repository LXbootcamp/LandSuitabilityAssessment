<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <style>
        /* body 스타일: 폰트, 배경색, 중앙 정렬 등을 설정 */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f7f7f7;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        /* 로그인 상태 div 스타일: 배경색, 패딩, 테두리, 그림자, 너비, 텍스트 정렬 설정 */
        #loginStatus {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 300px;
            text-align: center;
        }

        #loginStatus h2 {
            margin-bottom: 20px;
        }

        /* 로그인 폼 스타일: 플렉스 박스 설정 및 내부 정렬 */
        #loginStatus form {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* 입력 필드 스타일: 너비, 패딩, 마진, 테두리, 테두리 반경, 박스 크기 설정 */
        #loginStatus input[type="text"],
        #loginStatus input[type="password"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }

        /* 제출 버튼 스타일: 배경색, 텍스트 색, 패딩, 테두리, 테두리 반경, 커서, 너비, 마진 설정 */
        #loginStatus input[type="submit"] {
            background-color: black;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            margin: 20px 0;
        }

        /* 버튼 스타일: 배경색, 텍스트 색, 패딩, 테두리, 테두리 반경, 커서, 너비, 마진 설정 */
        #loginStatus button[type="button"] {
            background-color: white;
            color: #007bff;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
        }

        #loginStatus button[type="button"]:hover {
            text-decoration: underline;
        }

        #signupForm {
            display: none;
        }

        #signupTitle {
            display: none;
        }

        /* 아이콘 스타일: 너비, 높이, 마진 설정 및 중앙 정렬 */
        .icon {
            width: 100px;
            height: 100px;
            margin: 20px auto;
        }

        .icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        a {
            color: #007bff;
            text-decoration: none;
            margin-top: 10px;
        }

        a:hover {
            text-decoration: underline;
        }
    </style>
<link href="/style_07b0596c2b1323f7869a.css" rel="stylesheet"></head>

<body>
    <div id="loginStatus">
        <h2 id="loginTitle">로그인</h2>
        <div class="icon">
            <img src="/static/lxLogo.png" alt="Logo">
        </div>
        <form id="loginForm" method="POST" onsubmit="return validateLoginForm(event)">
            <label for="loginUsername">아이디</label>
            <input type="text" id="loginUsername" name="username" placeholder="아이디를 입력해주세요.">
            <label for="loginPassword">비밀번호</label>
            <input type="password" id="loginPassword" name="password" placeholder="비밀번호를 입력해주세요."
                autocomplete="current-password">
            <input type="submit" value="로그인">
            <a href="#" onclick="showSignupForm()">회원가입</a>
        </form>

        <h2 id="signupTitle" style="display:none;">회원가입</h2>
        <form id="signupForm" method="POST" onsubmit="return validateSignupForm(event)">
            <label for="signupUsername">아이디</label>
            <input type="text" id="signupUsername" name="username" placeholder="아이디를 입력해주세요.">
            <label for="signupPassword">비밀번호</label>
            <input type="password" id="signupPassword" name="password" placeholder="비밀번호를 입력해주세요."
                autocomplete="new-password">
            <label for="signupName">이름</label>
            <input type="text" id="signupName" name="name" placeholder="이름을 입력해주세요.">
            <label for="signupPhone">휴대폰번호</label>
            <input type="text" id="signupPhone" name="phone" placeholder="휴대폰번호를 입력해주세요.">
            <input type="submit" value="회원가입">
            <button type="button" onclick="hideSignupForm()">취소</button>
        </form>
    </div>

    <script>
        // HTML 특수문자 이스케이프 함수
        function escapeHtml(text) {
            var map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function (m) { return map[m]; });
        }

        // 로그인 폼 유효성 검사 및 제출 함수
        function validateLoginForm(event) {
            event.preventDefault();
            var username = document.getElementById('loginUsername').value;
            var password = document.getElementById('loginPassword').value;

            if (!username || !password) {
                alert('Both fields are required.');
                return false;
            }

            username = escapeHtml(username);
            password = escapeHtml(password);

            console.log('Sending login request:', { username, password });

            fetch('http://172.20.221.159:3000/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ username: username, password: password }),
                credentials: 'include'
            }).then(response => {
                if (response.headers.get('content-type')?.includes('application/json')) {
                    return response.json();
                } else {
                    throw new Error('Unexpected content type: ' + response.headers.get('content-type'));
                }
            }).then(data => {
                if (data.success) {
                    console.log('Login successful:', data);
                    alert('Login success!');
                    window.location.href = 'index.html';
                } else {
                    console.log('Login failed:', data);
                    alert('Login failed: ' + data.message);
                }
            }).catch(error => {
                console.error('Error:', error);
                alert('Login failed: ' + error.message);
            });

            return false;
        }

        // 회원가입 폼 유효성 검사 및 제출 함수
        function validateSignupForm(event) {
            event.preventDefault();
            var username = document.getElementById('signupUsername').value;
            var password = document.getElementById('signupPassword').value;
            var name = document.getElementById('signupName').value;
            var phone = document.getElementById('signupPhone').value;

            if (!username || !password || !name || !phone) {
                alert('All fields are required.');
                return false;
            }

            username = escapeHtml(username);
            password = escapeHtml(password);
            name = escapeHtml(name);
            phone = escapeHtml(phone);

            console.log('Sending signup request:', { username, password, name, phone });

            fetch('http://172.20.221.159:3000/signup', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ username: username, password: password, name: name, phone: phone }),
                credentials: 'include'
            }).then(response => {
                if (response.headers.get('content-type')?.includes('application/json')) {
                    return response.json();
                } else {
                    throw new Error('Unexpected content type: ' + response.headers.get('content-type'));
                }
            }).then(data => {
                if (data.success) {
                    console.log('Signup successful:', data);
                    alert('Signup success! You can now login.');
                    hideSignupForm();
                } else {
                    console.log('Signup failed:', data);
                    alert('Signup failed!');
                }
            }).catch(error => {
                console.error('Error:', error);
                alert('Signup failed: ' + error.message);
            });

            return false;
        }

        // 회원가입 폼을 보여주는 함수
        function showSignupForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('loginTitle').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
            document.getElementById('signupTitle').style.display = 'block';
        }

        // 회원가입 폼을 숨기는 함수
        function hideSignupForm() {
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('signupTitle').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('loginTitle').style.display = 'block';
        }

        // 페이지 로드 시 회원가입 폼을 숨기는 함수
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('signupTitle').style.display = 'none';
        });
    </script>
    <script type="module" src="/main_1c26ea12aa5d900eac93.js"></script>
<script type="module" src="/main_1c26ea12aa5d900eac93.js"></script></body>

</html>